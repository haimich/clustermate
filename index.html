<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Clustermate v0.1</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.2.6/cytoscape.js"></script>
</head>
<body>

    <div class="container-fluid">
        <div class="row"><h1 style="text-align: center">Clustermate</h1></div>
        
        <div class="row" style="margin-bottom: 20px">
            <button onClick="resetZoom()">Reset zoom</button>
            <button onClick="setLayout('grid')">Set layout: grid</button>
            <button onClick="setLayout('circle')">Set layout: circle</button>
            <button onClick="setLayout('random')">Set layout: random</button>
            <button onClick="exportPng()">Export PNG</button>
        </div>
    
        <div class="row">
            <div id="cy"></div>
        </div>
    
        <div class="row">
            <img id="png-export">
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            cy = cytoscape({
                container: document.getElementById('cy'),
    
                elements: [
                    // nodes
                    { group: 'nodes', data: { id: '3358071', name: 'WEB3' }},
                    { group: 'nodes', data: { id: '20636706', name: 'HR' }},
                    { group: 'nodes', data: { id: '1983844', name: 'HR' }},
                    { group: 'nodes', data: { id: '23892305', name: 'ND' }},
                    { group: 'nodes', data: { id: '23892306', name: 'ND' }},
                    { group: 'nodes', data: { id: '25040687', name: 'ND' }},
                    { group: 'nodes', data: { id: '25040688', name: 'ND' }},
                    { group: 'nodes', data: { id: '26295175', name: 'WEB5' }},
                    { group: 'nodes', data: { id: '30593337', name: 'WEB6' }},
                    { group: 'nodes', data: { id: '32456970', name: 'WEB7' }},
                    { group: 'nodes', data: { id: '37081047', name: 'SA' }},
                    { group: 'nodes', data: { id: '37316448', name: 'ND' }},
                    
                    //edges
                    { group: 'edges', data: { id: '3358071_20636706', source: '3358071', target: '20636706', name: 'duplicate', weight: 0.9 }},
                    { group: 'edges', data: { id: '23892305_32456970', source: '23892305', target: '32456970', name: 'duplicate', weight: 0.9 }},
                    { group: 'edges', data: { id: '23892305_23892306', source: '23892305', target: '23892306', name: 'duplicate', weight: 0.9 }},
                    { group: 'edges', data: { id: '25040687_30593337', source: '25040687', target: '30593337', name: 'duplicate', weight: 0.9 }},
                    { group: 'edges', data: { id: '25040687_25040688', source: '25040687', target: '25040688', name: 'duplicate', weight: 0.9 }},
                    { group: 'edges', data: { id: '25040687_26295175', source: '25040687', target: '26295175', name: 'duplicate', weight: 1 }},
                    { group: 'edges', data: { id: '25040687_37316448', source: '25040687', target: '37316448', name: 'duplicate', weight: 1 }},
                    { group: 'edges', data: { id: '25040687_32456970', source: '25040687', target: '32456970', name: 'duplicate', weight: 0.9 }},
                    { group: 'edges', data: { id: '3358071_37316448', source: '3358071', target: '37316448', name: 'deleted', weight: 0.9}},
                    { group: 'edges', data: { id: '3358071_26295175', source: '3358071', target: '26295175', name: 'deleted', weight: 0.9}},
                    { group: 'edges', data: { id: '3358071_20636706', source: '3358071', target: '20636706', name: 'deleted', weight: 0.9}},
                    { group: 'edges', data: { id: '3358071_30593337', source: '3358071', target: '30593337', name: 'deleted', weight: 0.9}},
                    { group: 'edges', data: { id: '3358071_25040688', source: '3358071', target: '25040688', name: 'deleted', weight: 0.9}},
                    { group: 'edges', data: { id: '3358071_32456970', source: '3358071', target: '32456970', name: 'deleted', weight: 0.9}},
                    { group: 'edges', data: { id: '3358071_25040687', source: '3358071', target: '25040687', name: 'deleted', weight: 0.9}},
                    { group: 'edges', data: { id: '26295175_37316448', source: '26295175', target: '37316448', name: 'deleted', weight: 0.9}},
                    { group: 'edges', data: { id: '26295175_32456970', source: '26295175', target: '32456970', name: 'obc-dup', weight: 0.9}},
                    { group: 'edges', data: { id: '26295175_30593337', source: '26295175', target: '30593337', name: 'obc-dup', weight: 0.9}},
                    { group: 'edges', data: { id: '25040688_37316448', source: '25040688', target: '37316448', name: 'obc-dup', weight: 0.9}},
                    { group: 'edges', data: { id: '25040688_26295175', source: '25040688', target: '26295175', name: 'obc-dup', weight: 0.9}},
                    { group: 'edges', data: { id: '25040688_32456970', source: '25040688', target: '32456970', name: 'obc-dup', weight: 0.9}},
                    { group: 'edges', data: { id: '25040688_30593337', source: '25040688', target: '30593337', name: 'obc-dup', weight: 0.9}},
                    { group: 'edges', data: { id: '20636706_25040687', source: '20636706', target: '25040687', name: 'obc-dup', weight: 0.9}},
                    { group: 'edges', data: { id: '20636706_30593337', source: '20636706', target: '30593337', name: 'obc-dup', weight: 0.9}},
                    { group: 'edges', data: { id: '20636706_25040688', source: '20636706', target: '25040688', name: 'updates', weight: 0.9}},
                    { group: 'edges', data: { id: '20636706_37316448', source: '20636706', target: '37316448', name: 'updates', weight: 0.9}},
                    { group: 'edges', data: { id: '20636706_26295175', source: '20636706', target: '26295175', name: 'updates', weight: 0.9}},
                    { group: 'edges', data: { id: '1983844_23892306', source: '1983844', target: '23892306', name: 'updates', weight: 0.9}},
                    { group: 'edges', data: { id: '1983844_23892305', source: '1983844', target: '23892305', name: 'updates', weight: 0.9}},
                    { group: 'edges', data: { id: '23892306_32456970', source: '23892306', target: '32456970', name: 'updates', weight: 0.9}},
                    { group: 'edges', data: { id: '32456970_37316448', source: '32456970', target: '37316448', name: 'updates', weight: 0.9}},
                    { group: 'edges', data: { id: '30593337_32456970', source: '30593337', target: '32456970', name: 'merge', weight: 0.3}},
                    { group: 'edges', data: { id: '37316448_25040688', source: '37316448', target: '25040688', name: 'merge', weight: 0.1}},
                    { group: 'edges', data: { id: '23892306_23892305', source: '23892306', target: '23892305', name: 'unmerge', weight: 0.1}},
                    { group: 'edges', data: { id: '25040688_25040687', source: '25040688', target: '25040687', name: 'unmerge', weight: 0.1}},
                ],
    
                style: 
                [
                    {
                        selector: 'node',
                        style: {
                            'label': 'data(name)',
                            'background-color': '#4db798',
                            'height': 48,
                            'width': 48,
                            'font-size': 13,
                            'text-valign': 'center',
                            'text-halign': 'center',
                            // 'border-color': '#000',
                            // 'border-width': 1,
                            // 'border-opacity': 0.5,
                        }
                    },
                    {
                        selector: 'edge',
                        style: {
                            'label': 'data(name)',
                            'width': 1.5,
                            'font-size': 12,
                            'line-color': '#ccc',
                            'text-margin-y': -12,
                            'curve-style': 'bezier',
                            'target-arrow-color': '#ccc',
                            'target-arrow-shape': 'triangle'
                        }
                    },
                    {
                        selector: 'edge[name = "deleted"]',
                        style: {
                            'line-color': 'red',
                        }
                    },
                    {
                        selector: 'edge[weight >= 0.9]',
                        style: {
                            'width': 2
                        }
                    },
                ],
    
               layout: {
                   name: 'random',
                   animate: true,
               },

            });
        });
        
        function resetZoom() {
            cy.fit();
        }
        
        function exportPng() {
            var png64 = cy.png();

            document.getElementById('png-export').src = png64;
        }
        
        function setLayout(name) {
            var options = {};
            
            if (name === "grid") {
                options = {
                    name: 'grid',
                    rows: 3,
                    animate: true,
                };
            } else if (name === "random") {
                options = {
                    name: 'random',
                    animate: true,
                };
            } else if (name === "circle") {
                options = {
                    name: 'circle',
                    animate: true,
                };
            }
            
            var layout = cy.layout(options);
            layout.run();
        }
    </script>

</body>
</html>